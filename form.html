<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(135deg, #4f46e5, #9333ea);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .autocomplete-suggestions {
      border: 1px solid #ddd;
      background: white;
      max-height: 150px;
      overflow-y: auto;
      border-radius: 8px;
      margin-top: 4px;
      position: absolute;
      width: 100%;
      z-index: 50;
    }
    .autocomplete-suggestion {
      padding: 8px;
      cursor: pointer;
    }
    .autocomplete-suggestion:hover {
      background: #f3f4f6;
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen">

  <div class="bg-white shadow-2xl rounded-2xl p-10 w-full max-w-xl transform transition hover:scale-105 duration-300">
    <h1 class="text-3xl font-bold text-center text-purple-600 mb-6 animate-pulse">
      Internship Recommendation Form
    </h1>

    <form id="studentForm" class="space-y-5 relative">
      
      <!-- Name -->
      <div>
        <label class="block text-gray-700 font-medium">Name</label>
        <input type="text" id="name" required
               class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-purple-500">
      </div>

      <!-- Current Study / Course (CS only) -->
      <div>
        <label class="block text-gray-700 font-medium">Current Study / Course</label>
        <select id="course"
                class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-purple-500">
          <option value="">Select Course</option>
          <option value="btech_cs">B.Tech Computer Science</option>
          <option value="mtech_cs">M.Tech Computer Science</option>
          <option value="bsc_cs">B.Sc Computer Science</option>
          <option value="msc_cs">M.Sc Computer Science</option>
          <option value="bca">BCA</option>
          <option value="mca">MCA</option>
          <option value="diploma_cs">Diploma in Computer Science</option>
        </select>
      </div>

      <!-- Skills -->
      <div class="relative">
        <label class="block text-gray-700 font-medium">Skills</label>
        <div id="skills-container"
             class="flex flex-wrap items-center border rounded-lg p-2 cursor-text min-h-[48px]"
             onclick="document.getElementById('skills-input').focus()">
          <input type="text" id="skills-input" placeholder="Type a skill and press Enter"
                 class="flex-1 outline-none p-2">
        </div>
        <div id="skills-suggestions" class="autocomplete-suggestions hidden"></div>
      </div>

      <!-- Location -->
      <div class="relative">
        <label class="block text-gray-700 font-medium">Preferred Locations</label>
        <div id="location-container"
             class="flex flex-wrap items-center border rounded-lg p-2 cursor-text min-h-[48px]"
             onclick="document.getElementById('location-input').focus()">
          <input type="text" id="location-input" placeholder="Type a location and press Enter"
                 class="flex-1 outline-none p-2">
        </div>
        <div id="location-suggestions" class="autocomplete-suggestions hidden"></div>
      </div>

      <!-- Preferred Field -->
      <div>
        <label class="block text-gray-700 font-medium">Preferred Field</label>
        <select id="field"
                class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-purple-500">
        </select>
      </div>

      <button type="submit"
              class="w-full bg-gradient-to-r from-purple-500 to-indigo-500 text-white py-3 px-4 rounded-lg hover:opacity-90 transition duration-300 font-bold">
        Get Recommendations
      </button>
    </form>
  </div>

  <script>
    // --- Data for skills, locations, fields ---
    const skillsList = ["Python", "SQL", "Machine Learning", "Deep Learning", "HTML", "CSS", "React", "Django", "Java", "C++", "JavaScript", "Node.js"];
    const locationList = ["Ahmedabad, Gujarat, India", "Bangalore, Karnataka, India", "Bhubaneswar", "Chennai, Tamil Nadu, India", "Coimbatore", "Delhi", "Gurgaon, Haryana, India", "Hyderabad, Telangana, India", "Hyderabad", "India", "Jaipur", "Kolkata", "Mumbai, Maharashtra, India", "Mumbai", "Mysore", "Nagpur", "New Delhi, India", "Noida, Uttar Pradesh, India", "Noida", "Pan India", "Pune, Maharashtra, India", "Pune", "Trivandrum", "Udupi", "Varanasi"];
    const fieldsList = ["AI/ML", "Data Science", "Web Development", "Mobile Development", "Cybersecurity", "Cloud Computing", "UI/UX", "DevOps", "Blockchain", "IoT"];

    // --- Fill field select ---
    const fieldSelect = document.getElementById("field");
    fieldsList.forEach(f => {
      const opt = document.createElement("option");
      opt.value = f;
      opt.textContent = f;
      fieldSelect.appendChild(opt);
    });

    // --- Multi-skill system ---
    let selectedSkills = [];
    const skillsContainer = document.getElementById("skills-container");
    const skillsInput = document.getElementById("skills-input");
    const skillsBox = document.getElementById("skills-suggestions");

    function renderSkills() {
      skillsContainer.querySelectorAll(".skill-tag").forEach(tag => tag.remove());
      selectedSkills.forEach(skill => {
        const tag = document.createElement("span");
        tag.textContent = skill;
        tag.className = "skill-tag bg-purple-200 text-purple-800 px-2 py-1 m-1 rounded-lg text-sm font-medium flex items-center";
        const removeBtn = document.createElement("button");
        removeBtn.textContent = "×";
        removeBtn.className = "ml-2 text-red-500 font-bold";
        removeBtn.onclick = () => {
          selectedSkills = selectedSkills.filter(s => s !== skill);
          renderSkills();
        };
        tag.appendChild(removeBtn);
        skillsContainer.insertBefore(tag, skillsInput);
      });
    }

    skillsInput.addEventListener("input", () => {
      const query = skillsInput.value.toLowerCase();
      skillsBox.innerHTML = "";
      if (!query) { skillsBox.classList.add("hidden"); return; }
      const matches = skillsList.filter(item => item.toLowerCase().includes(query) && !selectedSkills.includes(item));
      matches.forEach(match => {
        const div = document.createElement("div");
        div.classList.add("autocomplete-suggestion");
        div.textContent = match;
        div.onclick = () => {
          selectedSkills.push(match);
          skillsInput.value = "";
          skillsBox.classList.add("hidden");
          renderSkills();
        };
        skillsBox.appendChild(div);
      });
      skillsBox.classList.remove("hidden");
    });

    skillsInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && skillsInput.value.trim()) {
        e.preventDefault();
        const newSkill = skillsInput.value.trim();
        if (!selectedSkills.includes(newSkill)) selectedSkills.push(newSkill);
        skillsInput.value = "";
        skillsBox.classList.add("hidden");
        renderSkills();
      }
    });

    // --- Multi-location system ---
    let selectedLocations = [];
    const locationContainer = document.getElementById("location-container");
    const locationInput = document.getElementById("location-input");
    const locationBox = document.getElementById("location-suggestions");

    function renderLocations() {
      locationContainer.querySelectorAll(".location-tag").forEach(tag => tag.remove());
      selectedLocations.forEach(loc => {
        const tag = document.createElement("span");
        tag.textContent = loc;
        tag.className = "location-tag bg-indigo-200 text-indigo-800 px-2 py-1 m-1 rounded-lg text-sm font-medium flex items-center";
        const removeBtn = document.createElement("button");
        removeBtn.textContent = "×";
        removeBtn.className = "ml-2 text-red-500 font-bold";
        removeBtn.onclick = () => {
          selectedLocations = selectedLocations.filter(l => l !== loc);
          renderLocations();
        };
        tag.appendChild(removeBtn);
        locationContainer.insertBefore(tag, locationInput);
      });
    }

    locationInput.addEventListener("input", () => {
      const query = locationInput.value.toLowerCase();
      locationBox.innerHTML = "";
      if (!query) { locationBox.classList.add("hidden"); return; }
      const matches = locationList.filter(item => item.toLowerCase().includes(query) && !selectedLocations.includes(item));
      matches.forEach(match => {
        const div = document.createElement("div");
        div.classList.add("autocomplete-suggestion");
        div.textContent = match;
        div.onclick = () => {
          selectedLocations.push(match);
          locationInput.value = "";
          locationBox.classList.add("hidden");
          renderLocations();
        };
        locationBox.appendChild(div);
      });
      locationBox.classList.remove("hidden");
    });

    locationInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && locationInput.value.trim()) {
        e.preventDefault();
        const newLoc = locationInput.value.trim();
        if (!selectedLocations.includes(newLoc)) selectedLocations.push(newLoc);
        locationInput.value = "";
        locationBox.classList.add("hidden");
        renderLocations();
      }
    });

    // --- Submit handler ---
    const form = document.getElementById("studentForm");
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const studentData = {
        name: document.getElementById("name").value,
        course: document.getElementById("course").value,
        skills: selectedSkills,
        locations: selectedLocations,
        field: document.getElementById("field").value,
        top_n: 5
      };
      localStorage.setItem("studentData", JSON.stringify(studentData));
      window.location.href = "./results.html";
    });
  </script>
</body>
</html>
